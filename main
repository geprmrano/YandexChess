from androidhelper import sl4a
from haversine import haversine, Unit
from geographiclib.geodesic import Geodesic


def main():
    droid = sl4a.Android()
    while True:
        droid.startLocating()
        droid.eventWaitFor('location', int(9000))
        location = droid.readLocation().result
        try:
            print('Coordinates received')
            return (location['network']['latitude'], location['network']['longitude'])
        except KeyError:
            continue


target1 = main()
print('Enter target coordinates: ')
target2 = input().split()
target2 = float(target2[0]), float(target2[1])
print('Target distance received:', haversine(target1, target2, unit=Unit.METERS), sep='\n')
geodesic = Geodesic.WGS84
direction = geodesic.Inverse(target1, target2)['azi1']
if (direction >= 0 and direction <= 22) or (direction >= 338 and direction <= 360):
    print('The target is north of you')
elif direction >= 293 and direction <= 337:
    print('The target is northwest of you')
elif direction >= 248 and direction <= 292:
    print('The target is west of you')
elif direction >= 203 and direction <= 247:
    print('The target is southwest of you')
elif direction >= 158 and direction <= 202:
    print('The target is south of you')
elif direction >= 113 and direction <= 157:
    print('The target is southeast of you')
elif direction >= 76 and direction <= 112:
    print('The target is east of you')
elif direction >= 23 and direction <= 75:
    print('The target is northwest of you')
