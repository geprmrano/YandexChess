from androidhelper import sl4a
from haversine import haversine, Unit
from geographiclib.geodesic import Geodesic


def main():
    droid = sl4a.Android()
    while True:
        droid.startLocating()
        droid.eventWaitFor('location', int(9000))
        location = droid.readLocation().result
        try:
            print('Coordinates received')
            return (location['network']['latitude'], location['network']['longitude'])
        except KeyError:
            continue


target1 = main()
print('Enter target coordinates: ')
target2 = input().split()
target2 = float(target2[0]), float(target2[1])
print('Target distance received:', haversine(target1, target2, unit=Unit.METERS), sep='\n')
geodesic = Geodesic.WGS84
direction = geodesic.Inverse(target1, target2)['azi1']
if 0 >= direction <= 22 or 338 >= direction <= 360:
    print('The target is north of you')
elif 293 >= direction <= 337:
    print('The target is northwest of you')
elif 248 >= direction <= 292:
    print('The target is west of you')
elif 203 >= direction <= 247:
    print('The target is southwest of you')
elif 158 >= direction <= 202:
    print('The target is south of you')
elif 113 >= direction <= 157:
    print('The target is southeast of you')
elif 76 >= direction <= 112:
    print('The target is east of you')
elif 23 >= direction <= 75:
    print('The target is northwest of you')
